{
   "AWSTemplateFormatVersion" : "2010-09-09",
   "Description" : "EC2",
   "Parameters" : {
    
    "STACKNAME": {
      "Description" : "Name of an existing EC2 KeyPair to enable SSH access to the instance",
      "Type": "String",
    },

    "ImageId" : {
      "Type" : "String",
      "Default" : "ami-66506c1c",
    },

    "InstanceType" : {
      "Type" : "String",
      "Default" : "t2.micro",
      "AllowedValues" : ["t2.micro", "m1.small", "m1.large"],
      "Description" : "Enter t2.micro, m1.small, or m1.large. Default is t2.micro."
    },

    "Size" : {
      "Type" : "Number",
      "Default" : "16",
    },

    "VolumeType" : {
      "Type" : "String",
      "Default" : "gp2",
    },

   },

   "Resources" : {

      "EC2" : {

         "Type" : "AWS::EC2::Instance",
         "Properties" : {
            "ImageId" : { "Ref" : "ImageId" },
            "InstanceType" : { "Ref" : "InstanceType" },
            "DisableApiTermination" : "true",
            "Tags" : [
               {
                 "Key" : "Name",
                 "Value" : "MyTag"
               },  
            ]
         },
      },

      "Volume" : {
         "Type":"AWS::EC2::Volume",
         "Properties" : {
            "Size" : { "Ref" : "Size" },
            "Encrypted" : "true",
            "VolumeType" : { "Ref" : "VolumeType" },
            "AvailabilityZone" : { "Fn::GetAtt" : [ "EC2", "AvailabilityZone" ] },
         }
      },

      "myDynamoDBTable" : {
        "Type" : "AWS::DynamoDB::Table",
        "Properties" : {
          "AttributeDefinitions" : [
            {
              "AttributeName" : "id",
              "AttributeType" : "S"   
            }
          ],
          "KeySchema" : [
            {
              "AttributeName" : "id",
              "KeyType" : "HASH"
            }
          ],
          "ProvisionedThroughput" : {
            "ReadCapacityUnits" : "5",
            "WriteCapacityUnits" : "5"
          },
          "TableName" : "csye6225"
        }
      },

      "RecordServiceS3Bucket" : {
        "Type" : "AWS::S3::Bucket",
         "Properties" : {
           "BucketName" : "s3.csye6225-spring2018-jiaxi.me"
        }
      },

      "MyDB" : {
        "Type" : "AWS::RDS::DBInstance",
        "Properties" : {
          "DBName" : "csye6225",
          "Engine" : "MySQL",
          "EngineVersion" : "5.6.37",
          "DBInstanceClass" : "db.t2.medium",
          "MultiAZ" : "false",
          "DBInstanceIdentifier" : "csye6225-spring2018",
          "MasterUsername" : "csye6225master",
          "MasterUserPassword" : "csye6225password",
          "PubliclyAccessible" : "false",
          "Tags" : [ { "Key" : "Name", "Value" : "csye6225" } ],
          "AllocatedStorage" : "10"
        }
      }
    } 
}
      
